(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-5f24fe78"],{"0622":function(t,e,a){"use strict";var n=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"prefectInfo"},[a("a-form-model",{ref:"ruleForm",attrs:{model:t.data,rules:t.rules,"label-col":t.labelCol,"wrapper-col":t.wrapperCol}},[a("a-form-model-item",{attrs:{"has-feedback":"",label:"商品价格",prop:"price"}},[a("a-input",{model:{value:t.data.price,callback:function(e){t.$set(t.data,"price",e)},expression:"data.price"}})],1),a("a-form-model-item",{attrs:{label:"折扣价格",prop:"price_off"}},[a("a-input",{model:{value:t.data.price_off,callback:function(e){t.$set(t.data,"price_off",e)},expression:"data.price_off"}})],1),a("a-form-model-item",{attrs:{"has-feedback":"",label:"商品库存",prop:"inventory"}},[a("a-input",{model:{value:t.data.inventory,callback:function(e){t.$set(t.data,"inventory",e)},expression:"data.inventory"}})],1),a("a-form-model-item",{attrs:{"has-feedback":"",label:"计量单位",prop:"unit"}},[a("a-input",{model:{value:t.data.unit,callback:function(e){t.$set(t.data,"unit",e)},expression:"data.unit"}})],1),a("a-form-model-item",{attrs:{label:"商品相册"}},[a("a-upload",{attrs:{"list-type":"picture-card","file-list":t.fileList},on:{preview:t.handlePreview,change:t.handleChange}},[t.fileList.length<8?a("div",[a("a-icon",{attrs:{type:"plus"}}),a("div",{staticClass:"ant-upload-text"},[t._v("Upload")])],1):t._e()]),a("a-modal",{attrs:{visible:t.previewVisible,footer:null},on:{cancel:t.handleCancel}},[a("img",{staticStyle:{width:"100%"},attrs:{alt:"example",src:t.previewImage}})])],1),a("a-form-model-item",{attrs:{"wrapper-col":{span:14,offset:4}}},[a("a-button",{staticClass:"btn",attrs:{type:"primary"},on:{click:t.handleClick}},[t._v(" 上一步 ")]),a("a-button",{staticClass:"btn",attrs:{type:"primary"},on:{click:t.submit}},[t._v(" 提交 ")])],1)],1)],1)},r=[],i=a("1da1"),s=a("5530");a("96cf"),a("d3b7"),a("d81d");function c(t){return new Promise((function(e,a){var n=new FileReader;n.readAsDataURL(t),n.onload=function(){return e(n.result)},n.onerror=function(t){return a(t)}}))}var o={props:["data"],data:function(){return{previewVisible:!1,previewImage:"",fileList:[],labelCol:{span:4},wrapperCol:{span:14},other:"",result:"",rules:{price:[{required:!0,message:"请填写商品价格",trigger:"change"}],inventory:[{required:!0,message:"请填写商品价格",trigger:"change"}],unit:[{required:!0,message:"请填写商品价格",trigger:"change"}]}}},created:function(){this.fileList=this.data.images.map((function(t,e){return{uid:"".concat(e),name:"image".concat(e,".png"),status:"done",url:t}}))},methods:{submit:function(){var t=this.fileList.map((function(t){return t.url}));this.$emit("submit",Object(s["a"])(Object(s["a"])({},this.data),{},{images:t}))},resetCate:function(){this.data.c_item=""},handleClick:function(){this.$emit("prev")},handleCancel:function(){this.previewVisible=!1},handlePreview:function(t){var e=this;return Object(i["a"])(regeneratorRuntime.mark((function a(){return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:if(t.url||t.preview){a.next=4;break}return a.next=3,c(t.originFileObj);case 3:t.preview=a.sent;case 4:e.previewImage=t.url||t.preview,e.previewVisible=!0;case 6:case"end":return a.stop()}}),a)})))()},handleChange:function(t){var e=t.fileList;this.fileList=e}}},l=o,u=(a("0c9a"),a("2877")),d=Object(u["a"])(l,n,r,!1,null,"1c60b2c1",null);e["a"]=d.exports},"0670":function(t,e,a){},"0c9a":function(t,e,a){"use strict";a("9f01")},2323:function(t,e,a){"use strict";a("0670")},3626:function(t,e,a){},"6be2":function(t,e,a){"use strict";a.r(e);var n=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"list-container"},[a("Drawer"),a("div",{staticClass:"search"},[a("a-input",{staticStyle:{width:"200px"},attrs:{placeholder:"请输入关键词"},model:{value:t.keyWords,callback:function(e){t.keyWords=e},expression:"keyWords"}}),a("a-select",{staticClass:"seletCategory",staticStyle:{width:"120px"},attrs:{"default-value":1},model:{value:t.searchCategory,callback:function(e){t.searchCategory=e},expression:"searchCategory"}},t._l(this.cateList,(function(e,n){return a("a-select-option",{key:n,attrs:{value:n}},[t._v(" "+t._s(e)+" ")])})),1),a("a-button",{attrs:{type:"primary",icon:"search"},on:{click:t.handleClickSearch}},[t._v(" 检索 ")])],1),a("a-table",{attrs:{columns:t.columns,"row-key":function(t){return t._id},"data-source":t.data,pagination:t.pagination,loading:t.loading},on:{change:t.handleTableChange},scopedSlots:t._u([{key:"action",fn:function(e,n){return a("span",{},[a("span",{staticClass:"action",on:{click:function(e){return t.edit(n)}}},[t._v("编辑")]),a("a-divider",{attrs:{type:"vertical"}}),a("span",{staticClass:"action",on:{click:function(e){return t.del(n)}}},[t._v("删除")])],1)}}])})],1)},r=[],i=a("5530"),s=(a("d81d"),a("159b"),a("b0c0"),a("0c6d")),c=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"drawer-wrapper"},[a("a-drawer",{attrs:{title:"编辑商品",placement:"left",closable:!0,visible:t.visible,width:"90%","after-visible-change":t.afterVisibleChange},on:{close:t.onClose}},[a("a-steps",{staticClass:"steps",attrs:{current:t.current}},t._l(t.steps,(function(t){return a("a-step",{key:t.title,attrs:{title:t.title}})})),1),a("div",{staticClass:"steps-content"},[0==this.current?a("basicInfo",{attrs:{data:this.data},on:{next:t.next}}):1==this.current?a("prefectInfo",{attrs:{data:this.data},on:{prev:t.prev,submit:t.editSubmit}}):t._e()],1)],1)],1)},o=[];function l(t){if(Array.isArray(t))return t}a("a4d3"),a("e01a"),a("d3b7"),a("d28b"),a("3ca3"),a("ddb0");function u(t,e){var a=t&&("undefined"!==typeof Symbol&&t[Symbol.iterator]||t["@@iterator"]);if(null!=a){var n,r,i=[],s=!0,c=!1;try{for(a=a.call(t);!(s=(n=a.next()).done);s=!0)if(i.push(n.value),e&&i.length===e)break}catch(o){c=!0,r=o}finally{try{s||null==a["return"]||a["return"]()}finally{if(c)throw r}}return i}}var d=a("06c5");function f(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function p(t,e){return l(t)||u(t,e)||Object(d["a"])(t,e)||f()}var h=a("1da1"),m=(a("96cf"),a("b2e7")),b=a("0622"),v=a("bc3a"),g=a.n(v),y={data:function(){return{visible:!1,current:0,result:"",data:"",cateData:"",steps:[{title:"填写基本信息"},{title:"完善商品信息"}]}},components:{basicInfo:m["a"],prefectInfo:b["a"]},computed:{isBasis:function(){return this.current}},created:function(){var t=this;this.$bus.$on("close",this.onClose),this.$bus.$on("edit",function(){var e=Object(h["a"])(regeneratorRuntime.mark((function e(a){var n,r,i,c;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,g.a.all([Object(s["g"])({id:a.id}),Object(s["d"])()]);case 2:t.result=e.sent,n=t.result,r=p(n,2),i=r[0],c=r[1],t.data=i.data,t.cateData=c.data.data,t.$bus.$emit("info",t.cateData),t.visible=!0;case 9:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}())},mounted:function(){var t=this;this.$bus.$on("prev",(function(){t.current-=1}))},methods:{next:function(t){this.data=Object(i["a"])(Object(i["a"])({},this.data),t),this.current+=1},prev:function(){this.current-=1},afterVisibleChange:function(t){!1===t&&(this.current=0)},editSubmit:function(t){var e=this;return Object(h["a"])(regeneratorRuntime.mark((function a(){return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return a.next=2,Object(s["c"])(t).then((function(t){"success"===t.status&&(alert("提交成功"),e.$bus.$emit("refresh"),e.$bus.$emit("close"))}));case 2:case"end":return a.stop()}}),a)})))()},onClose:function(){this.visible=!1}}},w=y,C=(a("aa25"),a("2877")),k=Object(C["a"])(w,c,o,!1,null,"e3e6f9fe",null),_=k.exports,$={data:function(){return{data:[],flag:!1,pagination:{current:1,pageSize:10,total:1,showSizeChanger:!0},cateList:[],loading:!1,keyWords:null,searchCategory:null,status:["下架","上架"]}},components:{Drawer:_},created:function(){this.fetchCategory(),this.fetch()},computed:{columns:function(){return this.$store.state.headTitle}},methods:{handleTableChange:function(t){var e=Object(i["a"])({},this.pagination);e.current=t.current,e.pageSize=t.pageSize,this.pagination=e,this.fetch({size:this.pagination.pageSize,page:this.pagination.current})},fetch:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.loading=!0,Object(s["f"])(Object(i["a"])({page:1,size:10},e)).then((function(e){var a=e.data;a.data=a.data.map((function(e){return Object(i["a"])(Object(i["a"])({},e),{},{categoryName:t.cateList[e.category],upStatus:t.status[e.status]})}));var n=Object(i["a"])({},t.pagination);n.total=a.total,t.loading=!1,t.data=a.data,t.pagination=n}))},fetchCategory:function(){var t=this;Object(s["d"])({appkey:this.$store.state.userInfo.appkey}).then((function(e){e.data.data.forEach((function(e){t.cateList[e.id]=e.name})),t.cateList[0]="全部",t.$store.dispatch("setCategoryInfo",e.data.data)}))},edit:function(t){this.$bus.$emit("edit",t),this.$bus.$on("refresh",this.fetch),this.flag=!0},del:function(t){var e=this;Object(s["b"])({id:t.id}).then((function(t){alert(t.msg),e.fetch()}))},handleClickSearch:function(){this.fetch({searchWord:this.keyWords,category:0===this.searchCategory?null:this.searchCategory})}}},x=$,j=(a("2323"),Object(C["a"])(x,n,r,!1,null,"1a4b814f",null));e["default"]=j.exports},"9f01":function(t,e,a){},aa25:function(t,e,a){"use strict";a("3626")},b2e7:function(t,e,a){"use strict";var n=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"basicInfo"},[a("a-form-model",{ref:"ruleForm",attrs:{model:t.data,"label-col":t.labelCol,"wrapper-col":t.wrapperCol}},[a("a-form-model-item",{ref:"name",attrs:{"has-feedback":"",label:"标题",prop:"title",required:""}},[a("a-input",{on:{blur:function(){t.$refs.name.onFieldBlur()}},model:{value:t.data.title,callback:function(e){t.$set(t.data,"title",e)},expression:"data.title"}})],1),a("a-form-model-item",{ref:"desc",attrs:{"has-feedback":"",label:"商品描述",prop:"desc",required:""}},[a("a-input",{model:{value:t.data.desc,callback:function(e){t.$set(t.data,"desc",e)},expression:"data.desc"}})],1),a("a-form-model-item",{attrs:{label:"商品类别",prop:"category",required:""}},[a("a-select",{attrs:{placeholder:"请选择子类目"},on:{change:t.changeCategory},model:{value:t.data.category,callback:function(e){t.$set(t.data,"category",e)},expression:"data.category"}},t._l(t.cateData,(function(e){return a("a-select-option",{key:e.id,attrs:{value:e.id}},[t._v(" "+t._s(e.name)+" ")])})),1),a("a-select",{attrs:{placeholder:"请选择子类目"},model:{value:t.data.c_item,callback:function(e){t.$set(t.data,"c_item",e)},expression:"data.c_item"}},t._l(t.categoryItems,(function(e){return a("a-select-option",{key:e,attrs:{value:e}},[t._v(" "+t._s(e)+" ")])})),1)],1),a("a-form-model-item",{attrs:{label:"商品标签",prop:"tags"}},[a("a-select",{staticStyle:{width:"100%"},attrs:{mode:"tags",placeholder:"标签"},model:{value:t.data.tags,callback:function(e){t.$set(t.data,"tags",e)},expression:"data.tags"}},t._l(t.data.tags,(function(e,n){return a("a-select-option",{key:n,attrs:{value:e}},[t._v(" "+t._s(e)+" ")])})),1)],1),a("a-form-model-item",{attrs:{"wrapper-col":{span:14,offset:4}}},[a("a-button",{attrs:{type:"primary"},on:{click:t.handleClick}},[t._v(" 下一步 ")])],1)],1)],1)},r=[],i=a("0c6d"),s={props:["data"],data:function(){return{labelCol:{span:4},wrapperCol:{span:14},other:"",result:"",rules:{},cateData:[],categoryItems:[]}},created:function(){var t=this;Object(i["d"])().then((function(e){t.cateData=e.data.data,console.log(e)}))},methods:{changeCategory:function(t){for(var e=0;e<this.cateData.length;e+=1)this.cateData[e].id===t&&(this.categoryItems=this.cateData[e].c_items)},handleClick:function(){var t=this;this.$refs.ruleForm.validate((function(e){return console.log(e),e?(t.$emit("next",t.data),!0):(alert("填写有误!!"),!1)}))}}},c=s,o=a("2877"),l=Object(o["a"])(c,n,r,!1,null,null,null);e["a"]=l.exports}}]);
//# sourceMappingURL=chunk-5f24fe78.7b888727.js.map